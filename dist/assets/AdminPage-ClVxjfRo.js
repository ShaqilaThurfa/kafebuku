import{r as m,u as y,j as t,a as o,A as c}from"./index-BMFHAMQi.js";import{S as s}from"./sweetalert2.esm.all-DOYwHpwi.js";function j(){const[x,i]=m.useState([]),h=y(),l=async()=>{try{const{data:e}=await o.get(`${c}/admin/all-users`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});console.log("Fetched users:",e),i(e)}catch(e){s.fire({icon:"error",text:e.response?e.response.data.message:"Something went wrong!"}),h("/")}},u=async e=>{if((await s.fire({title:"Are you sure?",text:"Do you want to turn this user into User?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#d33",confirmButtonText:"Yes, turn into User!"})).isConfirmed)try{const r=await o.put(`${c}/admin/turn-into-user/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});i(n=>n.map(d=>d.id===e?{...d,role:"user"}:d)),s.fire("Success!","The user is now a User.","success")}catch(r){s.fire({icon:"error",text:r.response?r.response.data.message:"Something went wrong!"})}},b=async e=>{if((await s.fire({title:"Are you sure?",text:"Do you want to promote this user to Admin?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#d33",confirmButtonText:"Yes, make Admin!"})).isConfirmed)try{await o.put(`${c}/admin/add-admin/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),i(r=>r.map(n=>n.id===e?{...n,role:"Admin"}:n)),s.fire("Success!","The user is now an Admin.","success")}catch(r){s.fire({icon:"error",text:r.response?r.response.data.message:"Something went wrong!"})}},g=async e=>{if((await s.fire({title:"Are you sure?",text:"Do you really want to ban this user?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, ban it!"})).isConfirmed)try{await o.put(`${c}/admin/ban/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),s.fire("Banned!","The user has been banned.","success"),l()}catch(r){s.fire({icon:"error",text:r.response?r.response.data.message:"Something went wrong!"})}},p=async e=>{try{await o.put(`${c}/admin/unban/${e}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),l()}catch(a){s.fire({icon:"error",text:a.response?a.response.data.message:"Something went wrong!"})}};return m.useEffect(()=>{l()},[]),t.jsx("div",{className:"container mx-auto my-5 px-4",children:t.jsxs("table",{className:"w-full table-auto border-collapse border border-gray-300",children:[t.jsx("thead",{className:"bg-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"#"}),t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Full Name"}),t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Email"}),t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Status"}),t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"}),t.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Role"})]})}),t.jsx("tbody",{children:x.length>0?x.map((e,a)=>t.jsxs("tr",{className:`${a%2===0?"bg-gray-100":"bg-white"} hover:bg-gray-50`,children:[t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:a+1}),t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.fullName}),t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.email}),t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-semibold rounded ${e.status==="active"?"bg-green-500 text-white":"bg-gray-400 text-white"}`,children:e.status})}),t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.status==="active"?t.jsx("button",{className:"bg-red-500 hover:bg-red-600 text-white text-sm font-semibold px-3 py-1 rounded",onClick:()=>g(e.id),children:"Ban"}):t.jsx("button",{className:"bg-yellow-500 hover:bg-yellow-600 text-white text-sm font-semibold px-3 py-1 rounded",onClick:()=>p(e.id),children:"Unban"}),e.role==="user"?t.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white text-sm font-semibold px-3 py-1 rounded",onClick:()=>b(e.id),children:"Make Admin"}):t.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white text-sm font-semibold px-3 py-1 rounded",onClick:()=>u(e.id),children:"Make User"})]})}),t.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-semibold rounded ${e.role==="Admin"?"bg-green-500 text-white":"bg-gray-400 text-white"}`,children:e.role})})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"border border-gray-300 px-4 py-2 text-center",children:"No users found"})})})]})})}export{j as default};
