import{b as N,d as x,r as a,e as g,j as e,h as S,a as I,A as B}from"./index-BMFHAMQi.js";import{G}from"./index-DlT_pbP0.js";import{S as i}from"./sweetalert2.esm.all-DOYwHpwi.js";function F(){const n=N(),o=x(t=>t.novel.items),u=x(t=>t.novel.loading),[h,b]=a.useState(""),[p,l]=a.useState(!1),[f,d]=a.useState(""),[c,m]=a.useState(null);a.useEffect(()=>{n(g())},[n]);const y=async t=>{try{n(S(o.filter(s=>s.bookId!==t))),await I.put(`${B}/user/returnbook/${t}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}),n(g()),i.fire({text:"Book has been returned",icon:"success"})}catch(s){console.log(s),i.fire({text:s.response?s.response.data.message:"Something went wrong!"})}},j=async(t,s,k)=>{try{m(t),b(s);const r=`Buat cerita dengan judul "${s}" dengan deskripsi ${k} dalam bahasa Indonesia dengan panjang kata maksimal 500 kata, jangan sertakan judul, penulis dan deskripsi dalam cerita.`,w=(await new G("AIzaSyD4yrciJlQ4vU0HKgWo8x4PQBL6mWhrmVk").getGenerativeModel({model:"gemini-1.5-flash"}).generateContent(r)).response.candidates[0].content.parts[0].text;d(w),l(!0)}catch(r){i.fire({text:r.response?r.response.data.message:"Something went wrong!"}),d("Failed to generate story. Please try again."),l(!0)}finally{m(null)}};return e.jsxs("div",{className:"container p-10 my-5 max-w-screen-lg bg-[#8B4513] text-white text-lg font-bold rounded-lg shadow-lg gap-y-8",children:[o.length===0?e.jsx("p",{children:"You haven't borrowed any books."}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center mb-8",children:"My Borrowed Books"}),u?e.jsx("p",{children:"Loading books..."}):e.jsx("div",{className:"flex flex-wrap gap-y-4 justify-center",children:o.map(t=>e.jsx("div",{className:"flex card shadow-sm mx-3 w-full md:basis-1/2 lg:basis-1/4 max-w-sm bg-[#F5F5DC]",children:e.jsxs("div",{className:"card-body flex flex-col",children:[e.jsx("h5",{className:"card-title text-truncate",children:t.title}),e.jsx("h6",{className:"card-subtitle mb-2 text-muted",children:t.author}),e.jsxs("div",{className:"mt-auto",children:[e.jsx("span",{className:"badge bg-success mb-2",children:t.status}),e.jsx("button",{className:"btn btn-danger w-100 mb-2",onClick:()=>y(t.bookId),children:"Return"}),e.jsx("button",{className:"btn btn-info w-100",onClick:()=>j(t.bookId,t.title,t.description),disabled:c===t.bookId,children:c===t.bookId?"Generating...":"Generate Story"})]})]})},t.id))})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-5 rounded-lg w-11/12 max-w-lg",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h5",{className:"text-lg text-black font-bold",children:h}),e.jsx("button",{className:"text-red-500 font-bold",onClick:()=>l(!1),children:"X"})]}),e.jsx("div",{className:"overflow-y-auto max-h-80 my-4 text-sm text-black font-normal justify-end",children:c?e.jsx("p",{className:"text-center text-gray-500",children:"Generating story, please wait..."}):e.jsx("p",{children:f||"No story generated yet."})})]})})]})}export{F as default};
